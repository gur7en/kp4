\chapter{Объектно-ориентированное программирование}


\section{Реализация}
Информационная система была реализована на 
языке программирования C++ с использованием 
фреймворка Qt версии 6.7.1. 
Для хранения и обработки данных информационной системы 
была выбрана клиент-серверная СУБД PostgreSQL. 

Классы, ответственные за формирование и выполнение запросов к базе данных, 
для получения данных используют параметризированные запросы SQL.

Ни одна запись в таблице не может быть безвозвратно удалена 
из интерфейса программы, для чего применён паттерн Soft Delete
с помощью добавления дополнительного поля 
либо состояния существующего поля к записям,
для которых предусмотрена возможность удаления.

Для организации взаимодействия пользователя с системой была выбрана
архитектура Model-View, встроенная в Qt и являющаяся вариацией
паттерна Model-View-Controller. 
В качестве модели (Model) используется QSqlQueryModel. 
В качестве представления (View) используется QTableView.


\section{Сборка и запуск}
Сборку и запуск программы можно выполнить через IDE Qt Creator, 
выбрав файл проекта gruzop.pro и запустив сборку через 
графический интерфейс. 

Также сборку можно произвести в ручном режиме. Ниже описанные действия 
выполняются в директории с исходными текстами программы.
Программа предназначена для ОС семейства Linux.
Для сборки программы необходимо выполнить следующие команды:

\lstset{
    language=bash, basicstyle=\ttfamily,
    aboveskip=0mm, belowskip=5mm, xleftmargin=5mm
}

\begin{lstlisting}
    $ qmake path\to\gruzop.pro
    $ make -j8
    $ make clean
\end{lstlisting}

Параметр~\texttt{-j8} не является обязательным и предназначен для 
многопоточной сборки, что может ускорить процесс сборки, 
в данном случае будет задействовано 8~потоков сборки. Для изменения числа
потоков замените~8 на требуемое число.

Для работы собранной программы требуется наличие в системе
установленного пакета Qt версии не ниже 6.7.0, на более ранних
версиях работа программы не гарантируется. Также требуется
установленный и запущенный сервер PostgreSQL.

Для корректного первого запуска приложения необходимо запустить 
скрипт развёртывания базы данных, находящийся
в каталоге исходных текстов программы:

\begin{lstlisting}
    $ psql -U postgres -f dbinit.sql 
\end{lstlisting}

После этого администратор системы может приступить к 
созданию профилей пользователей, для чего предлагается 
использовать прямые запросы к базе данных. 
Соответствующие примеры могут быть найдены в файле~\texttt{examples.sql}. 
Необходимо понимание администратором принципов работы 
реляционных СУБД и минимальные знания языка~SQL.


\section{Тестирование}
Проводилось ручное тестирование информационной системы. В качестве 
примера ниже приведены действия, которые выполнялись при проверке 
прецедента <<войти в систему>>:
\begin{itemize}
    \item попытка войти, не заполнив поля имени пользователя и/или пароля;
    \item попытка войти, заполнив одно или оба поля пробелами;
    \item попытка войти с неверным именем пользователя и/или паролем;
    \item попытка войти с правильными именем пользователя и паролем.
\end{itemize}

В данном прецеденте все действия из приведённого списка, кроме последнего, должны
вызвать сообщение об ошибке, показанное на рисунке~\ref{fig:scr:loginerr}.
\image
    {screenshots/loginerr}
    {Сообщение об ошибке}
    {fig:scr:loginerr}

\newpage
Второй пример, для прецедента <<добавить маршрут>>:
\begin{itemize}
    \item попытка добавить маршрут, не заполнив одно или 
        несколько строковых полей;
    \item попытка добавить маршрут с именем, которое уже есть среди
        активных маршрутов;
    \item попытка ввести в числовые поля слишком большие числа,
        отрицательные числа, дроби, символы, не являющиеся числами;
    \item попытка добавить маршрут с корректными данными.
\end{itemize}

В данном прецеденте должна вызывать сообщение об ошибке, показанное на
рисунке~\ref{fig:scr:addrouteerr}, попытка добавить маршрут с недопустимыми
данными. Попытка же ввести неподходящие числа должна предотвращаться.
\image
    {screenshots/addrouteerr}
    {Сообщение об ошибке}
    {fig:scr:addrouteerr}

Тестирование проводилось для каждого прецедента, 
описанного в разделе~\ref{chap:spec}. 

В результате проведённого тестирования были 
выявлены и устранены следующие ошибки: 
\begin{itemize}
    \item можно было добавить два активных маршрута с одинаковыми названиями;
    \item можно было добавить маршрут с пустым именем;
    \item при добавлении перевозки при выборе одного и того же водителя 
        в обоих полях водитель назначался на перевозку дважды;
\end{itemize}


\section{Инструкции}
В качестве инструкций для пользователя можно использовать 
прецеденты, описанные в разделе~\ref{chap:spec}
и диаграммы последовательности, разработанные в разделе~\ref{chap:design}.
